<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!-- saved from url=(0063)http://course.cs.ust.hk/comp151h/S06/projects/texture/index.html -->

<HTML><HEAD><TITLE>CS 2012h Project 6 (extra): Texture</TITLE>

<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">

<META content="Microsoft FrontPage 5.0" name=GENERATOR></HEAD>

<BODY bgColor=#ffffff>

<STYLE type=text/css>BODY {

	FONT-SIZE: 10pt; FONT-FAMILY: Arial,Helvetica,sans-serif

}

TD {

	FONT-SIZE: 10pt; FONT-FAMILY: Arial,Helvetica,sans-serif

}

LI {

	FONT-SIZE: 10pt; FONT-FAMILY: Arial,Helvetica,sans-serif

}

.no_ul {

	TEXT-DECORATION: none

}

</STYLE>



<TABLE cellSpacing=5 cellPadding=0 width="100%" border=0>

  <TBODY>

  <TR>

    <TD width=80><A href="http://www.cs.ust.hk/course/comp151h/">

    <IMG height=98 

      src="../../img_files/logo_eye.gif" width=80 border=0></A></TD>

    <TD vAlign=bottom>

      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>

        <TBODY>

        <TR>

          <TD><A class=no_ul href="http://www.cs.ust.hk/course/comp2012h/"><FONT 

            face=Verdana,Arial,Helvetica,sans-serif color=#003366 

            size=4><B><FONT color=#ff9900>Object Oriented Programming 

            </FONT></B></FONT></A></TD></TR>

        <TR>

          <TD vAlign=top>

          <IMG height=2 src="../../img_files/6699cc.gif" 

            width="100%" border=0> </TD></TR>

        <TR>

          <TD><FONT face=Verdana,Arial,Helvetica,sans-serif color=#003366 

            size=2><B>Spring Semester 2013

  </B></FONT></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE><!-- Body -->

<TABLE cellSpacing=10 cellPadding=0 width="100%" border=0>

  <TBODY>

  <TR>

    <TD>&nbsp; 

      <TABLE cellPadding=10 width="100%">

        <TBODY>

        <TR>

          <TD width=288>

          <IMG height=200 alt=Paint 

            src="texture.gif" width=200></TD>

          <TD width="100%">

            <HR>



            <H2>Project 6 (extra): Texture</H2>

            <TABLE>

              <TBODY>

              <TR>

                <TD><B>Assigned : --</B><BR><B>Due : --</B> 

                  <P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: -5px">

                  <P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: -5px">

                  <P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: -5px">

                  <BLOCKQUOTE>&nbsp;</BLOCKQUOTE>

                <TD width=50>

                <TD>

                  <TABLE border=1>

                    <TBODY>

                    <TR>

                      <TD colSpan=7>

                        <CENTER><B>March/April</B> </CENTER>

                    <TR>

                      <TD><B>S </B>

                      <TD><B>M </B>

                      <TD><B>T </B>

                      <TD><B>W </B>

                      <TD><B>T </B>

                      <TD><B>F </B>

                      <TD><B>S </B>

                    <TR>

					  <TD>
                      <TD>5

                      <TD>6

                      <TD>7 

                      <TD>8 

                      <TD>9 

                      <TD>10

                       

                    <TR>
					  <TD>11
                      <TD>12 

                      <TD>13 

                      <TD>14 

                      <TD>15 

                      <TD bgColor=#88ff22>16 

                      <TD>17 

                       

                    <TR>
					  <TD>18
                      <TD>19 

                      <TD>20 

                      <TD>21 

                      <TD>22 

                      <TD>23

                      <TD>24 

                       

                    <TR>
					  <TD>25
                      <TD>26 

                      <TD>27 
					  <TD>28
					  <TD>29
                      <TD> 30
                      <TD> 31
					  </TR>
					  <TR>
                      <TD> 1
                      <TD>2
                      <TD>3
					  <TD>4
					  <TD bgColor=#ff0000>5
					  

                      <TD></TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>

            <HR>

          </TD></TR></TBODY></TABLE >

      <H2>Quick Links</H2>

      <OL>
	<LI><a href=7-texture.pdf>Lecture notes texture synthesis</a>
	<LI><a href="grading_scheme"> Project 2 grading scheme</a>
	<LI><a href="project2testimages.zip"> Project 2 grading images </a>
        <LI><A href="http://www.starnet.com/">X-Win32 official homepage</A>

        <LI><A 

        href="http://cssystem.cs.ust.hk/home.php?docbase=FAQ/hkust_only&amp;req_url=FAQ/hkust_only/displayx.html">Displaying 

        X applications to PC running X-Win32</A> 

        <LI><A 

        href="texture.linux">Sample 

        solution</A> <font size = -2>(only runs on Linux!) </font>

        <LI><A 

        href="wall.bmp">Sample 

        texture</A> <font size=-2>(parameters: window size=11, sigma = 10.0, sampling distance 

        = 1, epsilon = 0.10)</font> 

        <LI><A href="http://doc.qt.digia.com/3.2/classes.html" target=_blank>Qt 

        all class</A>

        <LI><A href="http://textures.forrest.cz/">Texture library</A>

        <LI><A 

        href="bitmap.h">bitmap.h</A> 

        <A 

        href="bitmap.cpp">bitmap.cpp</A>  

        <font size=-2>(use this or QImage <!-- QPixmap --> to load image, updated Mar 6, 2007)</font>

        <LI><A 

        href="efros-iccv99.pdf" 

        target=_blank>Algorithm description </A> <font size=-2>(read section 2.1)</font></LI></OL>

      <H2>Project Description</H2>In this assignment, you will implement a 

      texture synthesis algorithm (read <I><A 

      href="efros-iccv99.pdf" 

      target=_blank>this paper</A></I>, especially section 2.1) to create new 

      textures from a sample image. We have also summarized the main points below. You will use object oriented technique to 

      implement the program. You are also required to use Qt to develop a simple 

      GUI for your project.

      <H3>Texture synthesis algorithm</H3>

      <P>The algorithm can be summarized as below:</P>

      <P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%">1. 
      Randomly choose a 3x3 patch in the sample image and place it in the middle 
      of the new image.</P>

      <P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%">2. Find 

      all the boundary points.</P>

      <P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%">3. For 

      each boundary point,</P>

      <P 

      style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%">&nbsp;&nbsp;&nbsp; 
      3.1. Calculate the distance to each sample point using normalized sum of 

      squared differences.</P>

      <P 

      style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%">&nbsp;&nbsp;&nbsp; 

      3.2. Pick all the samples that have distance less than 

      (1+e)d<SUB>min</SUB>.</P>

      <P 

      style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%">&nbsp;&nbsp;&nbsp; 

      3.3. From those samples selected, randomly pick one as the color of the 

      new synthesized pixel.</P>

      <P style="MARGIN-TOP: 0px; MARGIN-BOTTOM: 0px; LINE-HEIGHT: 150%">4. 

      Repeat step 2 until all the pixels are synthesized.</P>

      <H5><I>Two-dimensional Gaussian kernel</I></H5>

      <P>You can let G = exp( -(x<SUP>2</SUP> + y<SUP>2</SUP>) / <FONT 

      face=Symbol>s</FONT><SUP>2</SUP><FONT face=Arial> ) where (x, y) is the 

      position and </FONT><FONT face=Symbol>s</FONT><FONT face=Arial> is the 

      standard deviation. If white represent 1 and black represent 0, the 

      Gaussian kernel will look like the following if you view it as an 

      image.</FONT></P>

      <P align=center>

      <IMG height=51 src="gaussian05.bmp" width=51 

      border=0> <FONT face=Symbol>s</FONT> = 5&nbsp;&nbsp;&nbsp;&nbsp; 

      <IMG 

      height=51 src="gaussian10.bmp" width=51 border=0> <FONT 

      face=Symbol>s</FONT> = 10&nbsp;&nbsp;&nbsp;&nbsp; 

      <IMG height=51 

      src="gaussian15.bmp" width=51 border=0> <FONT 

      face=Symbol>s</FONT> = 15&nbsp;&nbsp;&nbsp;&nbsp; 

      <IMG height=51 

      src="gaussian20.bmp" width=51 border=0> <FONT 

      face=Symbol>s</FONT> = 20</P>

      <H5><I>Sum of squared differences</I></H5>

      <P>To calculate the distance of two images, all you need to do is to 

      calculate the difference of each corresponding pixel and sum all the 

      differences to get the distance. Let the color of two corresponding pixels 

      be (R<SUB>1</SUB>, G<SUB>1</SUB>, B<SUB>1</SUB>) and (R<SUB>2</SUB>, 

      G<SUB>2</SUB>, B<SUB>2</SUB>). Then the difference is 

      (R<SUB>1</SUB>-R<SUB>2</SUB>)<SUP>2</SUP> + 

      (G<SUB>1</SUB>-G<SUB>2</SUB>)<SUP>2</SUP> + 

      (B<SUB>1</SUB>-B<SUB>2</SUB>)<SUP>2</SUP>.</P>

      <P>To give more weight to the nearby pixels, remember to multiply the 

      corresponding value of the Gaussian kernel at each pixel.</P>

      <h3>Implementation Details</h3>

      <h5><i>Step 1</i></h5>

      <p>Easy.</p>

      <h5><i>Step 2</i></h5>

      <P>This step is easy, the boundary points of the current synthesized image 

      are all the pixels that</P>

      <P style="line-height: 150%; margin-top: 0; margin-bottom: 0">&nbsp;&nbsp;&nbsp; 

      1. its color is equal to the background color, and</P>

      <P style="line-height: 150%; margin-top: 0; margin-bottom: 0">&nbsp;&nbsp;&nbsp; 

      2. there exist one or more pixels in its 8-neighbour that is not a 

      background pixel</P>

      <h5><i>Step 3.1</i></h5>

      <P>This step is the core part of the algorithm and you may spend most of 

      your time on it.</P>

      <P>First, you need to know where does your sample point come from. As 

      stated in the paper, the sample points are simply all the pixels on your 

      original image. To avoid exceeding the image boundary when calculating the 

      distance, you can exclude the pixels within half of the window size near 

      the boundary.</P>

      <P align="center">

      <img border="0" src="sample.bmp" width="235" height="271"></P>

      <P>Next, you have to find the distance of all the sample points to your 

      current synthesizing pixel. Here we will talk about the details on how to 

      find the distance of <b><i>one</i></b> sample point.</P>

      <P align="center">

      <img border="0" src="origin.bmp" width="200" height="220">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

      <img border="0" src="syn.bmp" width="200" height="220"></P>

      <P>The green square in the above images is your window and its width is 

      equal to the window size. In the sample image, the window is centered at 

      the sample point and the window is centered at the current synthesizing 

      pixel in the current synthesized image. To calculate the distance, first 

      you have to find the difference of the two sub-images formed by the two 

      windows. However, there are some background pixels in the current 

      synthesized image. All you need to do is to ignore them in the 

      calculation, that is, you only needed to take the difference at the pixels 

      in the red region shown above. After that, add 1 to the difference to make 

      it non-zero.</P>

      <P align="center"><img border="0" src="mask.bmp" width="200" height="200"></P>

      <P>After taking the difference (using sum of squared difference stated 

      above), you will have a number at each pixel in the red region. Now, 

      imagine that the center of the Gaussian kernel is moved to align with the 

      center of the window (shown as above). Then you need to multiply the 

      corresponding value in the Gaussian kernel to the difference at the 

      corresponding pixel in the window. Doing this will give a higher weight to 

      the pixels that are closer to the current synthesizing point. Summing all 

      the value at each pixel gives a single number that represent the distance 

      between the two red regions.</P>

      <P>The final goal is to find the distance between two windows (the final 

      distance you want). Since there exist some background pixels in the 

      synthesized image, we will use an approximation by normalizing the 

      distance of the two red regions. For example, if your window size is 21 x 

      21 = 441 pixels and you have 100 pixels in the red region, divide the 

      distance of the two red regions by (100 / 441) to get the final distance.</P>

      <h5><i>Step 3.2</i></h5>

      <P>After <i>Step 2.1</i>, you obtain the distance for each sample point. 

      Among these samples, there will be one sample that has the minimum 

      distance (most likely to be the color of the synthesizing pixel). To make 

      the synthesized image different from the original image, we select the 

      samples which have distance less than (1+e)d<SUB>min</SUB> as the 

      candidates for the color.</P>

      <h5><i>Step 3.3</i></h5>

      <P>Easy.</P>

      <H3>Project Requirement</H3>

      <P>Your program should</P>

      <OL>

        <LI>be able to load a sample image (BMP) and save the synthesized image 

        (BMP). 

        <LI>contains some UI to change the parameters of the algorithm (window 
        size, sigma, epsilon, background color). 

        <LI>output a bitmap file called &quot;result.bmp&quot; for every 100 pixels you 
        synthesized.<LI>of course, implement the algorithm correctly. </LI></OL>

      <P>If you have any difficulties in understanding the project requirement, 

      please take a look at the sample solution.</P>

      <H3>Hints</H3>

      <OL>

        <LI>Make sure you understand the algorithm before implementation. 

        <LI>Read Qt documentation. Here are some classes that you may need to 

        use, QPainter, QPixmap, QImage, QLabel, QSlider, QPushButton, QVBox, QHBox, 

        QFileDialog. 

        <LI>Separate the implementation of your algorithm and the UI. 

        <LI>Do your project earlier because the algorithm is slow and you need 

        more time to wait for the result. 

        <LI>You are not required to implement the status bar and timer in your 
        program (I implement it for fun).<LI>You may find that your program 
        looks hanged when you start the algorithm. It is normal because I used 
        some techniques you didn't learn before.<LI>Create some simple texture by your own to test your program before 

        running real textures. 

        <LI>See the example code in Qt API if you still have difficulties in 

        understanding the Qt API. 

        <LI>Test and fix all the bugs before submission. </LI></OL>

      <H2>Grading Scheme</H2>

      <P>A main objective of this course is to learn and practice good design 

      principles so that you can eventually write very large programs 

      comfortably and professionally. As such, you should not just turn in a 

      program that works. You are expected to have a good design too so that 

      your program is comprehensible and can be extended easily in case the 

      specification changes later. Whether you like it or not, it is a fact in 

      life that user requirements keep changing while a program is being 

      developed. Your design should be flexible enough to cater for such 

      possibilities. You should describe your design clearly in a separate file, 

      named <FONT size=-1>README.txt</FONT><FONT size=+0>.</FONT> </P>

      <P>As it is always the case, you should use meaningful identifier names in 

      your program so that other people can understand your code easily. You are 

      also expected to break your program into functionally distinct pieces kept 

      in different files, with the C++ source files compiled separately. Brief 

      yet informative comments should be added throughout the program to improve 

      its comprehensibility. 

      <P>The grading scheme is as follows: 

      <UL>

        <LI>Program correctness in satisfying specification (70%) 

        <LI>Object-oriented programming style and use of separate compilation 

        (15%) 

        <LI>Documentation and comprehensibility (15%) </LI></UL>

      <H2><FONT size=5>What to submit</FONT></H2>

      <OL>

        <LI>All the source code (.cpp and .h), but not the object code or 

        executable 

        <LI>Makefile and README.txt 
        <LI>Zip (1) and (2) inside a zip file (use the "zip" command in Unix) and upload 
                your </b>texture.zip</b> before 23:59 on the due date<br>

        <I>Warning: If your 

        submitted project fails to compile, or you put your zip file in the 

        wrong directory (note that the Unix filenames are case-sensitive), your 

        assignment will be treated as <B>late</B> (late policy will apply). 

        </I></LI></OL></TD></TR></TBODY></TABLE><TR><TD vAlign="top"><IMG height=2 

src="../../img_files/6699cc.gif" width="100%" border=0> </TD></TR>

<TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>

  <TBODY>

  <TR>

    <TD vAlign=top><FONT color=#999999 size=1>&nbsp;&nbsp;&nbsp;design by <A 

      href="mailto:kamlun@cs.ust.hk">Kam Lun TANG</A>, maintenance by <A 

      href="http://www.cs.ust.hk/~cktang/">Chi Keung Tang</A>. </FONT></TD>

    <TD vAlign=top align=right><A class=no_ul 

      href="http://www.cs.ust.hk/course/comp2012h/"><FONT color=#000000><B>CS 2012h 

      Object Oriented Programming </B></FONT></A><BR>Spring Semester 

      2011<BR>&nbsp; </TD>

    <TD>&nbsp;</TD>

    <TD vAlign=top width=40><A 

      href="http://www.cs.ust.hk/course/comp2012h/">

    <IMG height=40 

      src="../../img_files/pixel_cube.gif" width=40 border=0></A> </TD></TR>

  <TR>

    <TD>&nbsp;</TD>

    <TD vAlign=top align=right><FONT color=#999999>Last modified: Mon Apr  4 17:57:58 HKT 2013

</FONT></TD>

    <TD>&nbsp;</TD>

    <TD>&nbsp;</TD></TR></TBODY></TABLE></BODY></HTML>
